From f9d2d03254a58d92635a311a42253eeed5a40a47 Mon Sep 17 00:00:00 2001
From: Andreas Schwab <schwab@suse.de>
Date: Mon, 26 May 2014 18:01:31 +0200
Subject: [PATCH] Fix invalid file descriptor reuse while sending DNS query (BZ
 #15946)

---
 resolv/res_send.c |  1 +
 3 files changed, 17 insertions(+), 10 deletions(-)

diff --git a/resolv/res_send.c b/resolv/res_send.c
index 3273d55..af42b8a 100644
--- a/resolv/res_send.c
+++ b/resolv/res_send.c
@@ -1410,6 +1410,7 @@ send_dg(res_state statp,
 					retval = reopen (statp, terrno, ns);
 					if (retval <= 0)
 						return retval;
+					pfd[0].fd = EXT(statp).nssocks[ns];
 				}
 			}
 			goto wait;
-- 
2.0.0

