From 167e5b7297b8c5d7f0f4cdedc19e3a54bc5868a0 Mon Sep 17 00:00:00 2001
From: Mamoru TASAKA <mtasaka@fedoraproject.org>
Date: Wed, 28 May 2014 15:38:17 +0900
Subject: [PATCH 1/2] hacks/Makefile.in: add thread related flags correctly

xanalogtv related hacks now needs pthread related cflags / ldflags.
Add this correctly.
---
 hacks/Makefile.in | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

diff --git a/hacks/Makefile.in b/hacks/Makefile.in
index a98b1a5..697e8cf 100644
--- a/hacks/Makefile.in
+++ b/hacks/Makefile.in
@@ -31,6 +31,9 @@ DEFS		= -DSTANDALONE @DEFS@
 LIBS		= @LIBS@
 PERL		= @PERL@
 
+THREAD_LIBS	= @PTHREAD_LIBS@
+THREAD_CFLAGS	= @PTHREAD_CFLAGS@
+
 DEPEND		= @DEPEND@
 DEPEND_FLAGS	= @DEPEND_FLAGS@
 DEPEND_DEFINES	= @DEPEND_DEFINES@
@@ -661,7 +664,7 @@ epicycle:  	epicycle.o	$(HACK_OBJS) $(COL) $(ERASE)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(COL) $(ERASE) $(HACK_LIBS)
 
 interference:  interference.o	$(HACK_OBJS) $(COL) $(SHM) $(DBE) $(THRD)
-	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(COL) $(SHM) $(DBE) $(THRD) $(HACK_LIBS)
+	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(COL) $(SHM) $(DBE) $(THRD) $(HACK_LIBS) $(THREAD_CFLAGS) $(THREAD_LIBS)
 
 truchet:	 truchet.o	$(HACK_OBJS) $(COL)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(COL) $(HACK_LIBS)
@@ -670,10 +673,10 @@ bsod:	 	bsod.o		$(HACK_OBJS) $(GRAB) $(APPLE2) $(XPM)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(GRAB) $(APPLE2) $(XPM) $(XPM_LIBS)
 
 apple2:	 	apple2.o apple2-main.o	$(HACK_OBJS) $(ATV) $(GRAB) $(TEXT)
-	$(CC_HACK) -o $@ $@.o	apple2-main.o $(HACK_OBJS) $(ATV) $(GRAB) $(TEXT) $(XPM_LIBS) $(TEXT_LIBS)
+	$(CC_HACK) -o $@ $@.o	apple2-main.o $(HACK_OBJS) $(ATV) $(GRAB) $(TEXT) $(XPM_LIBS) $(TEXT_LIBS) $(THREAD_CFLAGS) $(THREAD_LIBS)
 
 xanalogtv: 	xanalogtv.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM)
-	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM) $(XPM_LIBS) $(HACK_LIBS)
+	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM) $(XPM_LIBS) $(HACK_LIBS) $(THREAD_CFLAGS) $(THREAD_LIBS)
 
 distort:	distort.o	$(HACK_OBJS) $(GRAB) $(SHM)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(GRAB) $(SHM) $(HACK_LIBS)
@@ -796,7 +799,7 @@ fontglide:	fontglide.o	$(HACK_OBJS) $(DBE) $(TEXT)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(DBE) $(TEXT) $(HACK_LIBS) $(TEXT_LIBS)
 
 pong: 	pong.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM)
-	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM) $(XPM_LIBS) $(HACK_LIBS)
+	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(ATV) $(GRAB) $(XPM) $(XPM_LIBS) $(HACK_LIBS) $(THREAD_CFLAGS) $(THREAD_LIBS)
 
 wormhole: 	wormhole.o	$(HACK_OBJS)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(HACK_LIBS)
@@ -841,7 +844,7 @@ m6502.h:
 
 m6502.o:	m6502.h
 m6502:		m6502.o		asm6502.o $(HACK_OBJS) $(ATV)
-	$(CC_HACK) -o $@ $@.o	asm6502.o $(HACK_OBJS) $(ATV) $(HACK_LIBS)
+	$(CC_HACK) -o $@ $@.o	asm6502.o $(HACK_OBJS) $(ATV) $(HACK_LIBS) $(THREAD_CFLAGS) $(THREAD_LIBS)
 
 abstractile:	abstractile.o	$(HACK_OBJS) $(COL)
 	$(CC_HACK) -o $@ $@.o	$(HACK_OBJS) $(COL) $(HACK_LIBS)
-- 
1.9.3

